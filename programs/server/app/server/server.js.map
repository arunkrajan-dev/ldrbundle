{"version":3,"sources":["meteor://ðŸ’»app/server/server.js"],"names":[],"mappings":"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","file":"/server/server.js","sourcesContent":["var verifyEmail = false;\n\nAccounts.config({ sendVerificationEmail: verifyEmail });\n\nMeteor.startup(function() {\n\t\n\t// read environment variables from Meteor.settings\n\tif(Meteor.settings && Meteor.settings.env && _.isObject(Meteor.settings.env)) {\n\t\tfor(var variableName in Meteor.settings.env) {\n\t\t\tprocess.env[variableName] = Meteor.settings.env[variableName];\n\t\t}\n\t}\n\n\t//\n\t// Setup OAuth login service configuration (read from Meteor.settings)\n\t//\n\t// Your settings file should look like this:\n\t//\n\t// {\n\t//     \"oauth\": {\n\t//         \"google\": {\n\t//             \"clientId\": \"yourClientId\",\n\t//             \"secret\": \"yourSecret\"\n\t//         },\n\t//         \"github\": {\n\t//             \"clientId\": \"yourClientId\",\n\t//             \"secret\": \"yourSecret\"\n\t//         }\n\t//     }\n\t// }\n\t//\n\tif(Accounts && Accounts.loginServiceConfiguration && Meteor.settings && Meteor.settings.oauth && _.isObject(Meteor.settings.oauth)) {\n\t\t// google\n\t\tif(Meteor.settings.oauth.google && _.isObject(Meteor.settings.oauth.google)) {\n\t\t\t// remove old configuration\n\t\t\tAccounts.loginServiceConfiguration.remove({\n\t\t\t\tservice: \"google\"\n\t\t\t});\n\n\t\t\tvar settingsObject = Meteor.settings.oauth.google;\n\t\t\tsettingsObject.service = \"google\";\n\n\t\t\t// add new configuration\n\t\t\tAccounts.loginServiceConfiguration.insert(settingsObject);\n\t\t}\n\t\t// github\n\t\tif(Meteor.settings.oauth.github && _.isObject(Meteor.settings.oauth.github)) {\n\t\t\t// remove old configuration\n\t\t\tAccounts.loginServiceConfiguration.remove({\n\t\t\t\tservice: \"github\"\n\t\t\t});\n\n\t\t\tvar settingsObject = Meteor.settings.oauth.github;\n\t\t\tsettingsObject.service = \"github\";\n\n\t\t\t// add new configuration\n\t\t\tAccounts.loginServiceConfiguration.insert(settingsObject);\n\t\t}\n\t\t// linkedin\n\t\tif(Meteor.settings.oauth.linkedin && _.isObject(Meteor.settings.oauth.linkedin)) {\n\t\t\t// remove old configuration\n\t\t\tAccounts.loginServiceConfiguration.remove({\n\t\t\t\tservice: \"linkedin\"\n\t\t\t});\n\n\t\t\tvar settingsObject = Meteor.settings.oauth.linkedin;\n\t\t\tsettingsObject.service = \"linkedin\";\n\n\t\t\t// add new configuration\n\t\t\tAccounts.loginServiceConfiguration.insert(settingsObject);\n\t\t}\n\t\t// facebook\n\t\tif(Meteor.settings.oauth.facebook && _.isObject(Meteor.settings.oauth.facebook)) {\n\t\t\t// remove old configuration\n\t\t\tAccounts.loginServiceConfiguration.remove({\n\t\t\t\tservice: \"facebook\"\n\t\t\t});\n\n\t\t\tvar settingsObject = Meteor.settings.oauth.facebook;\n\t\t\tsettingsObject.service = \"facebook\";\n\n\t\t\t// add new configuration\n\t\t\tAccounts.loginServiceConfiguration.insert(settingsObject);\n\t\t}\n\t\t// twitter\n\t\tif(Meteor.settings.oauth.twitter && _.isObject(Meteor.settings.oauth.twitter)) {\n\t\t\t// remove old configuration\n\t\t\tAccounts.loginServiceConfiguration.remove({\n\t\t\t\tservice: \"twitter\"\n\t\t\t});\n\n\t\t\tvar settingsObject = Meteor.settings.oauth.twitter;\n\t\t\tsettingsObject.service = \"twitter\";\n\n\t\t\t// add new configuration\n\t\t\tAccounts.loginServiceConfiguration.insert(settingsObject);\n\t\t}\n\t\t// meteor\n\t\tif(Meteor.settings.oauth.meteor && _.isObject(Meteor.settings.oauth.meteor)) {\n\t\t\t// remove old configuration\n\t\t\tAccounts.loginServiceConfiguration.remove({\n\t\t\t\tservice: \"meteor-developer\"\n\t\t\t});\n\n\t\t\tvar settingsObject = Meteor.settings.oauth.meteor;\n\t\t\tsettingsObject.service = \"meteor-developer\";\n\n\t\t\t// add new configuration\n\t\t\tAccounts.loginServiceConfiguration.insert(settingsObject);\n\t\t}\n\t}\n\n\t\n});\n\nMeteor.methods({\n\t\"createUserAccount\": function(options) {\n\t\tif(!Users.isAdmin(Meteor.userId())) {\n\t\t\tthrow new Meteor.Error(403, \"Access denied.\");\n\t\t}\n\n\t\tvar userOptions = {};\n\t\tif(options.username) userOptions.username = options.username;\n\t\tif(options.email) userOptions.email = options.email;\n\t\tif(options.password) userOptions.password = options.password;\n\t\tif(options.profile) userOptions.profile = options.profile;\n\t\tif(options.profile && options.profile.email) userOptions.email = options.profile.email;\n\n\t\tAccounts.createUser(userOptions);\n\t},\n\t\"updateUserAccount\": function(userId, options) {\n\t\t// only admin or users own profile\n\t\tif(!(Users.isAdmin(Meteor.userId()) || userId == Meteor.userId())) {\n\t\t\tthrow new Meteor.Error(403, \"Access denied.\");\n\t\t}\n\n\t\t// non-admin user can change only profile\n\t\tif(!Users.isAdmin(Meteor.userId())) {\n\t\t\tvar keys = Object.keys(options);\n\t\t\tif(keys.length !== 1 || !options.profile) {\n\t\t\t\tthrow new Meteor.Error(403, \"Access denied.\");\n\t\t\t}\n\t\t}\n\n\t\tvar userOptions = {};\n\t\tif(options.username) userOptions.username = options.username;\n\t\tif(options.email) userOptions.email = options.email;\n\t\tif(options.password) userOptions.password = options.password;\n\t\tif(options.profile) userOptions.profile = options.profile;\n\n\t\tif(options.profile && options.profile.email) userOptions.email = options.profile.email;\n\t\tif(options.roles) userOptions.roles = options.roles;\n\n\t\tif(userOptions.email) {\n\t\t\tvar email = userOptions.email;\n\t\t\tdelete userOptions.email;\n\t\t\tuserOptions.emails = [{ address: email }];\n\t\t}\n\n\t\tvar password = \"\";\n\t\tif(userOptions.password) {\n\t\t\tpassword = userOptions.password;\n\t\t\tdelete userOptions.password;\n\t\t}\n\n\t\tif(userOptions) {\n\t\t\tUsers.update(userId, { $set: userOptions });\n\t\t}\n\n\t\tif(password) {\n\t\t\tAccounts.setPassword(userId, password);\n\t\t}\n\t},\n\n\t\"sendMail\": function(options) {\n\t\tthis.unblock();\n\t\t\n\t  //if (!Meteor.user())\n    \t  //throw new Meteor.Error(403, \"User not logged in\");\n    \t  \n\t\t//console.log(\"Send mail clicked \" + JSON.stringify(options, null, 4));\n\t\tEmail.send(options);\n\t}\n});\n\nAccounts.onCreateUser(function (options, user) {\n\tconsole.log(\"on create user \" );\t\n\tif(!user.roles){\n\t\tif(Meteor.users.find().count()) {\n\t\t\tuser.roles = [\"user\"];\t\n\t\t} else {\n\t\t\tconsole.log(\"Creating new admin user\");\n\t\t\tuser.roles = [\"admin\"];\t\n\t\t\treturn user;\n\t\t}\n\t}\n\tconsole.log(\"user role: \" + user.roles);\t\n\t\n\t//Allow admin to create new user\n\tif(Users.isInRoles(Meteor.userId(), [\"admin\"])) return user;\n\t\n\t//If user is created through service, merge it to already \n\t//created account for the user by admin\n    if (user.services) {\n\t\t\tvar email = user.services[\"google\"].email;\n\t\t\t\n            if (!email)\n                throw new Meteor.Error(403, \"Email not found\");\n \t\t\t\n \t\t\tvar existingUser = Meteor.users.findOne({'emails.address': email});\n \t\t\t\n            // see if any existing user has this email address, otherwise create new\n            if (!existingUser)\n            \tthrow new Meteor.Error(403, \"Please request admin to add your mail in user list\");\n \n            // Remove existing user and create new account\n            Meteor.users.remove({_id: existingUser._id}); // remove existing record\n            return user;                          // record is re-inserted\n    }\n});\n\nAccounts.validateLoginAttempt(function(info) {\n\n\t// reject users with role \"blocked\"\n\tif(info.user && Users.isInRole(info.user._id, \"blocked\")) {\n\t\tthrow new Meteor.Error(403, \"Your account is blocked.\");\n\t}\n\n  if(verifyEmail && info.user && info.user.emails && info.user.emails.length && !info.user.emails[0].verified ) {\n\t\t\tthrow new Meteor.Error(499, \"E-mail not verified.\");\n  }\n\n\treturn true;\n});\n\n\nUsers.before.insert(function(userId, doc) {\n\tif(doc.emails && doc.emails[0] && doc.emails[0].address) {\n\t\tdoc.profile = doc.profile || {};\n\t\tdoc.profile.email = doc.emails[0].address;\n\t} else {\n\t\t// oauth\n\t\tif(doc.services) {\n\t\t\t// google e-mail\n\t\t\tif(doc.services.google && doc.services.google.email) {\n\t\t\t\tdoc.profile = doc.profile || {};\n\t\t\t\tdoc.profile.email = doc.services.google.email;\n\t\t\t} else {\n\t\t\t\t// github e-mail\n\t\t\t\tif(doc.services.github && doc.services.github.accessToken) {\n\t\t\t\t\tvar github = new GitHub({\n\t\t\t\t\t\tversion: \"3.0.0\",\n\t\t\t\t\t\ttimeout: 5000\n\t\t\t\t\t});\n\n\t\t\t\t\tgithub.authenticate({\n\t\t\t\t\t\ttype: \"oauth\",\n\t\t\t\t\t\ttoken: doc.services.github.accessToken\n\t\t\t\t\t});\n\n\t\t\t\t\ttry {\n\t\t\t\t\t\tvar result = github.user.getEmails({});\n\t\t\t\t\t\tvar email = _.findWhere(result, { primary: true });\n\t\t\t\t\t\tif(!email && result.length && _.isString(result[0])) {\n\t\t\t\t\t\t\temail = { email: result[0] };\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif(email) {\n\t\t\t\t\t\t\tdoc.profile = doc.profile || {};\n\t\t\t\t\t\t\tdoc.profile.email = email.email;\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\tconsole.log(e);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// linkedin email\n\t\t\t\t\tif(doc.services.linkedin && doc.services.linkedin.emailAddress) {\n\t\t\t\t\t\tdoc.profile = doc.profile || {};\n\t\t\t\t\t\tdoc.profile.name = doc.services.linkedin.firstName + \" \" + doc.services.linkedin.lastName;\n\t\t\t\t\t\tdoc.profile.email = doc.services.linkedin.emailAddress;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif(doc.services.facebook && doc.services.facebook.email) {\n\t\t\t\t\t\t\tdoc.profile = doc.profile || {};\n\t\t\t\t\t\t\tdoc.profile.email = doc.services.facebook.email;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif(doc.services.twitter && doc.services.twitter.email) {\n\t\t\t\t\t\t\t\tdoc.profile = doc.profile || {};\n\t\t\t\t\t\t\t\tdoc.profile.email = doc.services.twitter.email;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif(doc.services[\"meteor-developer\"] && doc.services[\"meteor-developer\"].emails && doc.services[\"meteor-developer\"].emails.length) {\n\t\t\t\t\t\t\t\t\tdoc.profile = doc.profile || {};\n\t\t\t\t\t\t\t\t\tdoc.profile.email = doc.services[\"meteor-developer\"].emails[0].address;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n});\n\nUsers.before.update(function(userId, doc, fieldNames, modifier, options) {\n\tif(modifier.$set && modifier.$set.emails && modifier.$set.emails.length && modifier.$set.emails[0].address) {\n\t\tmodifier.$set.profile.email = modifier.$set.emails[0].address;\n\t}\n});\n\nAccounts.onLogin(function (info) {\n\t\n});\n\nAccounts.urls.resetPassword = function (token) {\n\treturn Meteor.absoluteUrl('reset_password/' + token);\n};\n\nAccounts.urls.verifyEmail = function (token) {\n\treturn Meteor.absoluteUrl('verify_email/' + token);\n};\n"]}